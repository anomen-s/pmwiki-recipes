!!! Agorithm description
!!!!Encryption
: padding : plaintext is padded with spaces to achieve length of multiple of $AesCryptPadding
: nonce : pseudo-random 64bit nonce is generated
: counter : 64bit counter is set to zero
: key derivation : key is computed from password and possibly nonce (see below)
: encryption : plaintext is encrypted using AES-256 in CTR mode
: output : Base64-encoded concatenation of nonce and ciphertext

!!!!Decryption
: input : Base64-decode and split input to nonce and ciphertext
: counter : 64bit counter is set to zero
: key derivation : key is computed from password and possibly nonce (see below)
: decryption : ciphertext is decrypted using AES-256 in CTR mode
: trim : plaintext is trimmed


!!!KDF functions
Function is selected by  $AesCryptKDF variable.
Possible values are:
: sha256 : SHA-256 hash of password
: sha256_dup : SHA-256 hash of longer text constructed using password and nonce
: aes : encrypt password with AES, compatible with original aescrypt-0.1 recipe
: pbkdf2 : not yet implemented

!!!! Custom key derivation function
* use following template to create code which shall be inserted into @@local/config.php@@
[@
$AesCryptKDF='custom';
include_once("$FarmD/cookbook/aescrypt.php");
$HTMLHeaderFmt['aescrypt_custom'] = "
<script type=\"text/javascript\">
// <![CDATA[
AesCtr.kdf_custom = function(password, nBits, nonce) {

   var hash;
   // insert custom derivation function here
   // params:
   //   password - password given by user
   //   nBits - AES variant, always 256
   //   nonce - string of length 8 containing nonce, can be used as salt
   return hash;
}
// ]]>
</script>
";
@]

!!Links
* http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation


!!Java testing application
Build application using Maven:

 mvn install

Use following command to start command-line interface:

 java -jar JavaAesCryptTest-jar-with-dependencies.jar

Note: GUI interface is not yet implemented.

!!Test ciphers
Here are some test ciphers (mode/Password/Text/ciphertext):

sha256/TopSecret/test5:
fEaxTorFYjFnA33Bu5kRcw==


sha256_dup/TopSecret/test123456789:
+u3lTovF4nFv8dYNIaXjinWylW/W/6Sw


aes/TopSecret/test1234:
luTlTuHh4eHrEPklnMfcAb70

aes/TopSecret/zkou≈°ka:
4OTlTtTU1NSvedV6iKTpxy5G

aes/testing1234/Encrypt this text:
CuXlTpiYmJgivaCAyM1nGHjC/T3jUhHhoLXz
